<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Reset Password</title>
<link rel="stylesheet" href="../css/styles.css">
</head>
<body>
	<?php
	include("../include/config.php");
	if(isset($_POST["getOTP"])){
		$to = $_POST['UserID'];
		$check_UserID = check_NguoiDung($to);
		if($check_UserID==null){ ?>
			<script>
				alert("Tên người dùng nhập không có!");
			</script>
		<?php }
		else{
				$otp = get_OTP($to);
				$mail = $check_UserID['Email'];
				$subject = "Forgot password - 2ENG";
				$message = "Xin chào! Bạn hoặc một ai đó đã sử dụng chức năng quên mật khẩu. Nếu bạn muốn đặt lại mật khẩu thì nhập mã OTP sau đây: ";
				$message = $message.$otp;
				$head = "from: 18521155@gm.uit.edu.vn";
				if(mail($mail, $subject, $message, $head)){
					header("Location:enterOTP.php?userid=".$to);
				}
				else{ ?>
					<script>
						alert("Gửi mail không thành công! Bạn kiểm tra lại đường truyền hoặc thông tin hộp thư bị chặn.");
					</script>
				<?php }
		}
	}
	?>
<div id="Web_1920__1">
	<svg class="Rectangle_1">
		<rect id="Rectangle_1" rx="113" ry="113" x="0" y="0" width="606" height="544">
		</rect>
	</svg>
	<img id="Image_1" src="../img/imgResetPassword.PNG">
	<div id="Did_someone_forget_their_passw">
		<span>Did someone forget their password?</span>
	</div>
	<div id="Thats_ok_Just_enter_the_User_I">
		<span>That's ok...<br/>Just enter the User ID you've used to<br/>register with us and we'll send your mail a reset OTP</span>
	</div>
	<div id="Your_UserID_">
		<span>Your UserID: </span>
	</div>
	<svg class="Icon_awesome-user-lock" viewBox="0 0 29 24.64">
		<path id="Icon_awesome-user-lock" d="M 10.15000057220459 12.32012939453125 C 13.35325145721436 12.32012939453125 15.95000076293945 9.562173843383789 15.95000076293945 6.160064697265625 C 15.95000076293945 2.757954597473145 13.35325145721436 0 10.15000057220459 0 C 6.946748733520508 0 4.350000381469727 2.757954835891724 4.350000381469727 6.160064697265625 C 4.350000381469727 9.562173843383789 6.946749210357666 12.32012939453125 10.15000057220459 12.32012939453125 Z M 14.5 15.40016078948975 C 14.50327587127686 14.88576030731201 14.62957096099854 14.38068008422852 14.86703109741211 13.93233299255371 C 14.64953136444092 13.90827083587646 14.43656253814697 13.86014556884766 14.21000003814697 13.86014556884766 L 13.45328140258789 13.86014556884766 C 11.35717105865479 14.88679027557373 8.942832946777344 14.88679027557373 6.846719741821289 13.86014556884766 L 6.089999675750732 13.86014556884766 C 2.728255271911621 13.86014556884766 0.001500829122960567 16.75488471984863 0 20.32676887512207 L 0 22.33023452758789 C 0 23.60602378845215 0.9737807512283325 24.6402587890625 2.175000190734863 24.6402587890625 L 14.90328216552734 24.6402587890625 C 14.64267063140869 24.17397308349609 14.50348663330078 23.64247512817383 14.49999904632568 23.10024261474609 L 14.5 15.40016078948975 Z M 27.55000114440918 13.86014556884766 L 26.10000038146973 13.86014556884766 L 26.10000038146973 10.01010513305664 C 26.10000038146973 7.883786678314209 24.4770336151123 6.160064697265625 22.47500038146973 6.160064697265625 C 20.47296905517578 6.160064697265625 18.85000038146973 7.883786678314209 18.85000038146973 10.01010513305664 L 18.85000038146973 13.86014556884766 L 17.40000152587891 13.86014556884766 C 16.59918785095215 13.86014556884766 15.95000076293945 14.54963397979736 15.95000076293945 15.40016078948975 L 15.95000076293945 23.10024261474609 C 15.95000076293945 23.95076942443848 16.59918785095215 24.6402587890625 17.40000152587891 24.6402587890625 L 27.55000114440918 24.6402587890625 C 28.35081481933594 24.6402587890625 29 23.95076942443848 29 23.10024261474609 L 29 15.40016078948975 C 29 14.54963397979736 28.35081481933594 13.86014556884766 27.55000114440918 13.86014556884766 Z M 22.47500038146973 20.79021835327148 C 21.67418670654297 20.79021835327148 21.02500152587891 20.10072898864746 21.02500152587891 19.25020217895508 C 21.02500152587891 18.39967155456543 21.67418670654297 17.71018600463867 22.47500038146973 17.71018600463867 C 23.27581405639648 17.71018600463867 23.92500114440918 18.39967155456543 23.92500114440918 19.25020217895508 C 23.92500114440918 20.10072898864746 23.27581405639648 20.79021835327148 22.47500038146973 20.79021835327148 Z M 23.92500114440918 13.86014556884766 L 21.02500152587891 13.86014556884766 L 21.02500152587891 10.01010513305664 C 21.02500152587891 9.159577369689941 21.67418670654297 8.470088958740234 22.47500038146973 8.470088958740234 C 23.27581405639648 8.470088958740234 23.92500114440918 9.159577369689941 23.92500114440918 10.01010513305664 L 23.92500114440918 13.86014556884766 Z">
		</path>
	</svg>
	<div id="form">
			<form action="" method = "POST">
				</br><input type="text" class="Rectangle_2" name="UserID" value="">
				<br>
				<br><input type="submit" class="Path_1" name="getOTP" value="Get OTP" </br> 
			</form>
	</div>
</div>
</body>
</html>